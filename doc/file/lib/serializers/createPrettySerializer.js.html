<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">lib/serializers/createPrettySerializer.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="https://github.com/cchamberlain/bunyan-serializer" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">serializers</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createPrettySerializer">createPrettySerializer</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">lib/serializers/createPrettySerializer.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">

/**
 * createPrettySerializer is a thunk that takes configuration parameters and returns a bunyan serializer function.
 * @param  {boolean} options.showName     Enables printing the logger name in logs. (false)
 * @param  {boolean} options.showHostname Enables printing the hostname in logs. (false)
 * @param  {boolean} options.showPid      Enables printing the process id in the logs. (true)
 * @param  {boolean} options.showTime     Enables printing the timestamp in the logs. (true)
 * @param  {boolean} options.showError    Enables printing errors in the logs. (true)
 * @param  {boolean} options.showSilly    Prints additional debug information into the logs. (false)
 * @return {bunyanSerializer}             Returns a pretty formatting bunyanSerializer function that converts bunyan write input to human readable text.
 */
export default function createPrettySerializer( { showName = false
                                                , showHostname = false
                                                , showPid = true
                                                , showTime = true
                                                , showError = true
                                                , showSilly = false
                                                } = {}) {
  /**
   * prettySerializer takes arguments from a bunyan WritableStream&apos;s write method and formats output in a human readable format.
   * @param  {...Object} args - args that were passed to WritableStream.prototype.write()
   * @return {string}           human readable string
   */
  return function prettySerializer(...args) {
    try {
      let record = x
      try {
        record = typeof x === &apos;string&apos; ? JSON.parse(x) : x
      } catch(err) {
        return `INTERNAL|UNPARSEABLE=${record}`
      }
      const { name, hostname, pid, level, msg, time, v, err } = record
      let levelName = level ? LEVEL_MAP[level] : &apos;UNKNOWN&apos;
      let output = `${levelName}`
      if(showName &amp;&amp; name)
        output += `|NAME=${name}`
      if(showHostname &amp;&amp; hostname)
        output += `|HOSTNAME=${hostname}`
      if(showPid &amp;&amp; pid)
        output += `|PID=${pid}`
      if(showTime &amp;&amp; time)
        output += `|${time}`
      if(v)
        output += `|V=${v}`
      output += `|${msg}`

      if(showError &amp;&amp; err) {
        const { message, stack } = err
        output += `|ERR=${message}\n${stack}`
      }
      if(showSilly)
        output += `\nSILLY =&gt; KEYS=[${Object.keys(record).join(&apos;, &apos;)}]`
      return output
    } catch(err) {
      return `INTERNAL|ERR=an error occurred formatting output =&gt; ${err.message || err}`
    }
  }
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.7)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
